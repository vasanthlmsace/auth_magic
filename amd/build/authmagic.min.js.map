{"version":3,"sources":["../src/authmagic.js"],"names":["define","$","Fragment","ModalFactory","ModalEvents","notification","String","AuthMagic","params","self","enrolstatus","displayAuthInfoBox","setTimeout","copyBoardButton","document","querySelectorAll","addEventListener","copyTextCliboard","bind","cancopylink","copyuserLoginlink","loginhook","magicLoginHook","hascourseregister","courseQuickRegistration","prototype","uniqueid","courseid","addHandler","singleButton","createElement","setAttribute","form","url","courseblock","submit","strquickregister","appendChild","authSelector","strbutton","getMagicLink","classList","remove","add","userNameBlock","span","passInfo","get_string","when","done","localizedEditString","innerHTML","potentialiDp","prev","potentialiDpList","length","hide","e","preventDefault","returnurl","currentTarget","getAttribute","userEmail","mailSelector","value","magicLogin","email","parentNode","magicForm","invitationlink","forEach","items","userlogin","copyText","copyTextBlock","select","copytext","modal","navigator","clipboard","textArea","style","top","left","position","body","focus","execCommand","err","removeChild","writeText","create","title","strconfirm","type","types","CANCEL","getAuthMagicBody","large","then","show","getRoot","on","hidden","destroy","window","open","catch","exception","loadFragment","contextid","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Magic authentication define js.\n * @module   auth_magic\n * @copyright  2022 bdecent gmbh <https://bdecent.de>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'core/fragment', 'core/modal_factory', 'core/modal_events', 'core/notification', 'core/str'],\n function($, Fragment, ModalFactory, ModalEvents, notification, String) {\n\n    /**\n     * Controls Custom styles tool action.\n     * @param {object} params\n     */\n    var AuthMagic = function(params) {\n        var self = this;\n        if (params.enrolstatus !== undefined) {\n            self.displayAuthInfoBox(params);\n            setTimeout(function() {\n                var copyBoardButton = document.querySelectorAll(\".auth-magic-block .copy-link-block #copy-cliboard\")[0];\n                if (copyBoardButton) {\n                    copyBoardButton.addEventListener(\"click\", self.copyTextCliboard.bind(self));\n                }\n            }, 2000);\n        }\n        if (params.cancopylink !== undefined) {\n            self.copyuserLoginlink(params.cancopylink);\n        }\n        if (params.loginhook) {\n            self.magicLoginHook(params);\n        }\n        if (params.hascourseregister) {\n            self.courseQuickRegistration(params);\n        }\n    };\n\n    AuthMagic.prototype.courseQuickRegistration = function(params) {\n        var uniqueid = \"user-index-participants-\" + params.courseid;\n        var handleSelector = \".pagelayout-incourse [data-table-uniqueid=\" + uniqueid + \"]\";\n        var addHandler = document.querySelectorAll(handleSelector);\n        if (addHandler) {\n            var singleButton = document.createElement(\"div\");\n            singleButton.setAttribute(\"class\", \"singlebutton quickregister-button\");\n\n            // Create a form.\n            var form = document.createElement(\"form\");\n            form.setAttribute(\"method\", \"get\");\n            form.setAttribute(\"action\", params.url);\n            form.setAttribute(\"id\", \"quickregister-button\");\n\n            // Create an input element for Full Name\n            var courseblock = document.createElement(\"input\");\n            courseblock.setAttribute(\"type\", \"hidden\");\n            courseblock.setAttribute(\"name\", \"courseid\");\n            courseblock.setAttribute(\"value\", params.courseid);\n\n            var submit = document.createElement(\"input\");\n            submit.setAttribute(\"type\", \"submit\");\n            submit.setAttribute(\"value\", params.strquickregister);\n            submit.setAttribute(\"class\", \"btn btn-secondary my-1\");\n\n            form.appendChild(courseblock);\n            form.appendChild(submit);\n            singleButton.appendChild(form);\n            addHandler[0].appendChild(singleButton);\n        }\n    };\n\n    AuthMagic.prototype.magicLoginHook = function(params) {\n        var authSelector = \"#page-login-index .potentialidplist a[title=\\\"\" + params.strbutton + \"\\\"]\";\n        var getMagicLink = document.querySelectorAll(authSelector)[0];\n            if (getMagicLink) {\n                getMagicLink.classList.remove(\"btn-secondary\");\n                getMagicLink.classList.add(\"btn-primary\");\n                var userNameBlock = document.querySelectorAll(\"#page-login-index form#login .form-group\")[0];\n                if (userNameBlock) {\n                    userNameBlock.appendChild(getMagicLink);\n                    // Create a span.\n                    var span = document.createElement(\"span\");\n                    span.setAttribute(\"class\", \"magic-password-instruction\");\n                    var passInfo = String.get_string('passinfo', 'auth_magic');\n                    $.when(passInfo).done(function(localizedEditString) {\n                        span.innerHTML = localizedEditString;\n                   });\n                    userNameBlock.appendChild(span);\n                }\n                var potentialiDp = $(\"#page-login-index .potentialidplist\").prev();\n                var potentialiDpList = document.querySelectorAll(\"#page-login-index .potentialidplist .potentialidp\");\n                if (potentialiDpList.length <= 1) {\n                    $(potentialiDp).hide();\n                }\n                getMagicLink.addEventListener(\"click\", function(e) {\n                    e.preventDefault();\n                    var returnurl = e.currentTarget.getAttribute(\"href\");\n                    var userEmail = \"\";\n                    var mailSelector = document.querySelectorAll(\"form#login #username\")[0];\n                    if (mailSelector) {\n                        userEmail = mailSelector.value;\n                    }\n                    // Create a form.\n                    var form = document.createElement(\"form\");\n                    form.setAttribute(\"method\", \"post\");\n                    form.setAttribute(\"action\", returnurl);\n                    form.setAttribute(\"id\", \"magic-login-form\");\n\n                     // Create an input element for Full Name\n                    var magicLogin = document.createElement(\"input\");\n                    magicLogin.setAttribute(\"type\", \"hidden\");\n                    magicLogin.setAttribute(\"name\", \"magiclogin\");\n                    magicLogin.setAttribute(\"value\", 1);\n\n                    var email = document.createElement(\"input\");\n                    email.setAttribute(\"type\", \"hidden\");\n                    email.setAttribute(\"name\", \"usermail\");\n                    email.setAttribute(\"value\", userEmail);\n\n                    form.appendChild(magicLogin);\n                    form.appendChild(email);\n\n                    getMagicLink.parentNode.appendChild(form);\n\n                    var magicForm = document.querySelectorAll(\"form#magic-login-form\")[0];\n                    magicForm.submit();\n                });\n            }\n    };\n\n    AuthMagic.prototype.copyuserLoginlink = function(cancopylink) {\n        var self = this;\n        if (cancopylink) {\n            var invitationlink = document.querySelectorAll(\"table.magicinvitationlink .magic-invitationlink\");\n            if (invitationlink) {\n                invitationlink.forEach(function(items) {\n                    items.addEventListener('click', function(e) {\n                        e.preventDefault();\n                        var userlogin = e.currentTarget.getAttribute(\"data-invitationlink\");\n                        self.copyText(userlogin);\n                    });\n                });\n            }\n        }\n    };\n\n    AuthMagic.prototype.copyTextCliboard = function() {\n        var self = this;\n        var copyTextBlock = document.querySelectorAll(\".auth-magic-block #copy-text\")[0];\n        if (copyTextBlock) {\n            self.copyText(copyTextBlock.value, true);\n            copyTextBlock.select();\n        }\n    };\n\n    AuthMagic.prototype.copyText = function(copytext, modal = false) {\n        if (typeof (navigator.clipboard) == 'undefined') {\n            var textArea = document.createElement(\"textarea\");\n            textArea.value = copytext;\n            // Avoid scrolling to bottom\n            textArea.style.top = \"0\";\n            textArea.style.left = \"0\";\n            textArea.style.position = \"fixed\";\n            if (!modal) {\n                document.body.appendChild(textArea);\n            } else {\n                document.querySelectorAll(\".modal .modal-content\")[0].appendChild(textArea);\n            }\n            textArea.focus();\n            textArea.select();\n            try {\n                document.execCommand('copy');\n            } catch (err) {\n                return false;\n            }\n            if (!modal) {\n                document.body.removeChild(textArea);\n            } else {\n                document.querySelectorAll(\".modal .modal-content\")[0].removeChild(textArea);\n            }\n        } else {\n            navigator.clipboard.writeText(copytext);\n        }\n        return true;\n    };\n\n    AuthMagic.prototype.displayAuthInfoBox = function(params) {\n        var self = this;\n        ModalFactory.create({\n            title: params.strconfirm,\n            type: ModalFactory.types.CANCEL,\n            body: self.getAuthMagicBody(params),\n            large: true\n        }).then(function(modal) {\n\n            modal.show();\n            modal.getRoot().on(ModalEvents.hidden, function() {\n                modal.destroy();\n                window.open(params.returnurl, '_self');\n            });\n            return modal;\n        }).catch(notification.exception);\n    };\n\n    AuthMagic.prototype.getAuthMagicBody = function(params) {\n        return Fragment.loadFragment('auth_magic', 'display_box_content', params.contextid, params);\n    };\n\n    return {\n        init: function(params) {\n            return new AuthMagic(params);\n        }\n    };\n\n });"],"file":"authmagic.min.js"}